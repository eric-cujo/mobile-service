get:
  tags:
    - Threats API(PA)
    - SECURITY (PA)
  summary: Get details for some threat
  description: Get the details for some specific threat
  operationId: GetDetailsForThreat
  responses:
    200:
      description: OK.
      content:
        application/json:
          schema:
            $ref: "/src/swagger.yaml#/components/schemas/ThreatDetails"
          examples:
            threat:
              value:
                partnerAgentId: 6742b3bc41692673c83385235484030b02
                deviceId: 2797216
                deviceMac: b8:27:eb:29:77:4b
                seen: false
                metadata:
                  ip: 42.7.26.16
                  port: 22
                id: 343859
                agentId: 2797203
                type: REMOTE_ACCESS
                interactionType: NOTIFICATION
                direction: IN
                description:
                  We detected an unauthorized attempt to access your
                  device "Generic CUJO IoT device" on port 22 from an IP 42.7.26.16
                  which originates from China.
                level: CRITICAL
                action: block
                geolocation: China
                customerAction: NO_ACTION
                startedAt: 1524133474538
                endedAt: 1524133474538
  security:
    - AccessToken: []
put:
  tags:
    - SECURITY (PA)
    - Threats API(PA)
  summary: Change the action for some threat
  description: Change the action (ignore or block) for some specific threat
  operationId: ChangeActionForThreat
  requestBody:
    content:
      application/json:
        schema:
          $ref: "/src/swagger.yaml#/components/schemas/UpdateThreatActionRequest"
        examples:
          action:
            value:
              action: ignore
    required: true
  responses:
    200:
      description: OK.
      content:
        application/json:
          schema:
            $ref: "/src/swagger.yaml#/components/schemas/UpdateThreatActionResponse"
          examples:
            ack:
              value:
                id: 28
                agentId: 456
                partnerAgentId: 04:23:dd:67:89:ab
                type: remote access
                interactionType: INTERACTIVE
                description:
                  We blocked an unauthorized attempt to access device
                  "IP Camera" from IP "111.111.65.1"
                level: critical
                action: ignore
  security:
    - AccessToken: []
parameters:
  - $ref: "/src/swagger.yaml#/components/schemas/AgentIdOrPartnerAgentIdParameter"
  - name: threatId
    in: path
    description: Threat id
    required: true
    schema:
      type: integer
