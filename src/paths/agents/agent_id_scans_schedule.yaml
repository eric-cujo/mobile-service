get:
  deprecated: true
  tags:
    - Vulnerability Scan API(PA)
    - SECURITY (PA)
  summary: On-demand vulnerability scan status
  description: Provides information about on-demand vulnerability scan status
  operationId: OnDemandVulnerabilityScanStatus
  responses:
    200:
      description: OK.
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: "/src/swagger.yaml#/components/schemas/OnDemandInfo"
          examples:
            info:
              value:
                - state: SCHEDULED|FINISHED|NONE
                  deviceId: 12
                  lastScan: 1475148966
  security:
    - AccessToken: []
  x-code-samples:
    - lang: CURL
      source: |-
        curl -X GET \
        https://api.cujo.io/v1/agents/3156132/scans/schedule
put:
  deprecated: true
  tags:
    - Vulnerability Scan API(PA)
    - SECURITY (PA)
  summary: Enable on-demand vulnerability scan for given agent
  description: Enable on-demand vulnerability scan for given agent
  operationId: EnableOnDemandVulnerabilityScanForGivenAgent
  requestBody:
    content:
      application/json:
        schema:
          $ref: "/src/swagger.yaml#/components/schemas/EnableOnDemandRequest"
        examples:
          enableDevices:
            value:
              deviceIds:
                - 12
                - 15
                - 90
    required: true
  responses:
    200:
      description: OK.
      content:
        application/json:
          schema:
            type: array
            items:
              $ref: "/src/swagger.yaml#/components/schemas/OnDemandInfo"
          examples:
            schedule:
              value:
                - state: SCHEDULED|FINISHED|NONE
                  deviceId: 12
                  lastScan: 1475148966
  security:
    - AccessToken: []
  x-code-samples:
    - lang: CURL
      source: |-
        curl -X PUT \
          https://api.cujo.io/v1/agents/3156132/scans/schedule \
          -d $'{
            "deviceIds": [12, 15, 90]
          }'
parameters:
  - $ref: "/src/swagger.yaml#/components/schemas/AgentIdOrPartnerAgentIdParameter"
