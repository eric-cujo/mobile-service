post:
  tags:
    - Vulnerability API
  summary: Initiate scan for a given agent
  description: Initiate scan for a given agent on given time (recurring, all devices)
  operationId: InitiateRecurringScan
  requestBody:
    content:
      application/json:
        schema:
            $ref: "/src/swagger.yaml#/components/schemas/InitiateRecurringScanReq"
        examples:
          schedule:
            value:
              - agentId: 1
                weekDays:
                  - 1
                  - 2
                  - 3
                scanStartTime: 01:00
                scanFinishTime: 02:00
              - agentId: 2
                weekDays:
                  - 1
                  - 2
                  - 3
                scanStartTime: 01:00
                scanFinishTime: 02:00

  responses:
    200:
      description: Initiated scan
      content:
        application/json:
          schema:
              $ref: "/src/swagger.yaml#/components/schemas/InitiateRecurringScanResp"
          examples:
            schedule:
              value:
                - scanSchedulerName: 2903593
                  deviceId: 2903589
                  weekDays:
                    - 1
                    - 2
                    - 3
                  scanStartTime: 01:00
                  scanFinishTime: 02:00
                - scanSchedulerName: 2903593                -
                  deviceId: 2903589
                  weekDays:
                    - 1
                    - 2
                    - 3
                  scanStartTime: 01:00
                  scanFinishTime: 02:00
